<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catat Utang Piutang</title>

<style>
:root{
  --blue:#2563eb;
  --bg:#f4f6f8;
  --card:#ffffff;
  --border:#e5e7eb;
  --muted:#6b7280;
  --plus:#16a34a;
  --minus:#dc2626;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:var(--bg);
}

.app{
  max-width:420px;
  margin:auto;
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

header{
  text-align:center;
  padding:18px;
}

main{flex:1;padding:16px}

.card{
  background:var(--card);
  padding:16px;
  border-radius:16px;
}

label{
  font-size:13px;
  font-weight:600;
  margin-top:12px;
  display:block;
}

input,select,textarea{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--border);
  margin-top:6px;
}

button{
  margin-top:16px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  background:var(--blue);
  color:white;
  font-weight:700;
}

.history{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

.column{
  background:#f9fafb;
  padding:12px;
  border-radius:14px;
}

.total{text-align:center;font-weight:700;margin-bottom:8px}

.item{
  background:white;
  border:1px solid var(--border);
  padding:8px;
  border-radius:8px;
  margin-bottom:6px;
  font-size:13px;
  position:relative;
}

.item small{color:var(--muted)}

.menu{
  position:absolute;
  right:6px;
  top:6px;
  cursor:pointer;
}

.menu-box{
  display:none;
  position:absolute;
  right:0;
  top:22px;
  background:white;
  border:1px solid var(--border);
  border-radius:8px;
}

.menu-box div{
  padding:8px 12px;
  cursor:pointer;
}

.menu-box div:hover{background:#f3f4f6}

.plus{color:var(--plus)}
.minus{color:var(--minus)}

nav{
  position:sticky;
  bottom:0;
  display:flex;
  border-top:1px solid var(--border);
  background:white;
}

nav button{
  flex:1;
  border:none;
  padding:14px;
  font-weight:600;
  background:none;
}

.active{background:#eef2ff}
</style>
</head>

<body>
<div class="app">

<header>
  <h2>Utang Piutang</h2>
  <small>Njel & Ria</small>
</header>

<!-- HOME -->
<main id="home">
  <div class="card">
    <label>Aksi</label>
    <select id="type">
      <option value="ria-utang">Ria utang Njel</option>
      <option value="njel-utang">Njel utang Ria</option>
      <option value="ria-bayar">Ria bayar Njel</option>
      <option value="njel-bayar">Njel bayar Ria</option>
    </select>

    <label>Tanggal</label>
    <input type="date" id="date">

    <label>Jumlah</label>
    <input type="number" id="amount">

    <label>Catatan</label>
    <textarea id="note"></textarea>

    <button onclick="addTx()">Simpan</button>
  </div>
</main>

<!-- HISTORY -->
<main id="history" style="display:none">
  <div class="history">
    <div class="column">
      <h3>Njel</h3>
      <div id="totalNjel" class="total"></div>
      <div id="logNjel"></div>
    </div>
    <div class="column">
      <h3>Ria</h3>
      <div id="totalRia" class="total"></div>
      <div id="logRia"></div>
    </div>
  </div>
</main>

<nav>
  <button class="active" onclick="tab('home',this)">üè† Home</button>
  <button onclick="tab('history',this)">üìú History</button>
</nav>

</div>

<script>
let db = JSON.parse(localStorage.getItem("utangDB")) || {
  saldo:{Njel:0,Ria:0},
  tx:[]
};

function save(){
  localStorage.setItem("utangDB",JSON.stringify(db));
  render();
}

function addTx(){
  const amt = Number(amount.value);
  if(!amt) return alert("Jumlah kosong");

  const t = type.value;
  const d = date.value || new Date().toISOString().slice(0,10);

  let njel=0, ria=0, text="";

  if(t==="ria-utang"){ ria-=amt; njel+=amt; text=`Ria utang Njel Rp${amt}`;}
  if(t==="njel-utang"){ njel-=amt; ria+=amt; text=`Njel utang Ria Rp${amt}`;}
  if(t==="ria-bayar"){ ria+=amt; njel-=amt; text=`Ria bayar Njel Rp${amt}`;}
  if(t==="njel-bayar"){ njel+=amt; ria-=amt; text=`Njel bayar Ria Rp${amt}`;}

  db.saldo.Njel+=njel;
  db.saldo.Ria+=ria;

  db.tx.push({id:Date.now(),date:d,text,njel,ria});

  amount.value="";
  note.value="";
  save();
}

function del(id){
  const t = db.tx.find(x=>x.id===id);
  db.saldo.Njel-=t.njel;
  db.saldo.Ria-=t.ria;
  db.tx=db.tx.filter(x=>x.id!==id);
  save();
}

function render(){
  totalNjel.innerHTML=`<span class="${db.saldo.Njel>=0?'plus':'minus'}">${db.saldo.Njel}</span>`;
  totalRia.innerHTML=`<span class="${db.saldo.Ria>=0?'plus':'minus'}">${db.saldo.Ria}</span>`;

  logNjel.innerHTML="";
  logRia.innerHTML="";

  db.tx.forEach(t=>{
    const item = `
      <div class="item">
        <div class="menu" onclick="this.nextElementSibling.style.display='block'">‚ãÆ</div>
        <div class="menu-box">
          <div onclick="del(${t.id})">Hapus</div>
        </div>
        <small>${t.date}</small>
        ${t.text}
      </div>`;

    if(t.njel!==0) logNjel.innerHTML+=item;
    if(t.ria!==0) logRia.innerHTML+=item;
  });
}

function tab(id,btn){
  home.style.display=id==="home"?"block":"none";
  history.style.display=id==="history"?"block":"none";
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

render();
</script>
</body>
</html>
