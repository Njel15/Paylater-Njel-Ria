<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Upload GitHub</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: sans-serif; background: #f0f2f5; padding: 15px; margin: 0; }
        .card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
        .btn-box { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .opt { position: relative; border: 2px dashed #ccc; padding: 10px; text-align: center; border-radius: 8px; font-size: 13px; cursor: pointer; }
        .opt input { position: absolute; opacity: 0; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer; }
        .opt.active { border-color: #28a745; background: #eaffef; color: #28a745; border-style: solid; }
        .btn-up { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 14px; cursor: pointer; }
        .btn-up:disabled { background: #ccc; }
        .status { text-align: center; font-size: 12px; margin-top: 8px; font-weight: bold; }
    </style>
</head>
<body>

    <h2 style="text-align: center;">GitHub Admin Upload</h2>
    <div id="item-list"></div>

<script>
    // MASUKKAN URL WEB APP GOOGLE KAMU DI SINI
    const SCRIPT_URL = "GANTI_DENGAN_URL_WEB_APP_KAMU";

    const list = document.getElementById('item-list');
    const selectedFiles = {};

    for (let i = 1; i <= 10; i++) {
        list.innerHTML += `
            <div class="card">
                <div style="margin-bottom:10px; font-weight:bold;">ITEM #${i} <span id="info${i}" style="color:red; font-weight:normal; font-size:11px;">No Photo</span></div>
                <input type="text" id="name${i}" placeholder="Product Name">
                <input type="number" id="price${i}" placeholder="Price (Ex: 100000)">
                <div class="btn-box">
                    <div class="opt" id="optC${i}">üì∑ Camera <input type="file" accept="image/*" capture="environment" onchange="handleFile(${i}, this, 'C')"></div>
                    <div class="opt" id="optG${i}">üñºÔ∏è Gallery <input type="file" accept="image/*" onchange="handleFile(${i}, this, 'G')"></div>
                </div>
                <button id="btn${i}" class="btn-up" onclick="uploadItem(${i})">UPLOAD ITEM #${i}</button>
                <div id="msg${i}" class="status"></div>
            </div>`;
    }

    function handleFile(id, input, type) {
        if (input.files && input.files[0]) {
            selectedFiles[id] = input.files[0];
            document.getElementById('info'+id).innerText = "Ready ‚úÖ";
            document.getElementById('info'+id).style.color = "green";
            document.getElementById('optC'+id).className = (type === 'C') ? 'opt active' : 'opt';
            document.getElementById('optG'+id).className = (type === 'G') ? 'opt active' : 'opt';
        }
    }

    async function uploadItem(id) {
        const name = document.getElementById('name'+id).value;
        const price = document.getElementById('price'+id).value;
        const file = selectedFiles[id];
        const btn = document.getElementById('btn'+id);
        const msg = document.getElementById('msg'+id);

        if (!file || !name || !price) return alert("Fill all fields!");

        btn.disabled = true;
        btn.innerText = "Uploading...";
        msg.innerText = "Processing...";

        try {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = async () => {
                const base64 = reader.result;
                const fileName = name.replace(/ /g, '_') + "_Price_" + price + ".jpg";

                const response = await fetch(SCRIPT_URL, {
                    method: "POST",
                    body: JSON.stringify({ base64: base64, fileName: fileName })
                });

                const result = await response.json();
                if (result.result === "OK") {
                    btn.innerText = "SUCCESS ‚úÖ";
                    btn.style.background = "#28a745";
                    msg.innerText = "Successfully saved to Drive!";
                } else {
                    throw new Error(result.error);
                }
            };
        } catch (e) {
            btn.disabled = false;
            btn.innerText = "RETRY";
            msg.innerText = "Error: " + e;
        }
    }
</script>
</body>
</html>
